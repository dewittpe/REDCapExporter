<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Peter DeWitt" />

<meta name="date" content="2019-03-01" />

<title>REDCap Exporter</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">REDCap Exporter</h1>
<h4 class="author"><em>Peter DeWitt</em></h4>
<h4 class="date"><em>2019-03-01</em></h4>


<div id="TOC">
<ul>
<li><a href="#prerequisites-and-tokens"><span class="toc-section-number">1</span> Prerequisites and Tokens</a><ul>
<li><a href="#namespaces-options-and-system-environment-variables"><span class="toc-section-number">1.1</span> Namespaces, Options, and System Environment Variables</a></li>
</ul></li>
<li><a href="#general-tools"><span class="toc-section-number">2</span> General Tools</a><ul>
<li><a href="#specific-export-methods"><span class="toc-section-number">2.1</span> Specific Export Methods</a></li>
<li><a href="#data-import-tools"><span class="toc-section-number">2.2</span> Data Import Tools</a></li>
</ul></li>
<li><a href="#exporting-a-redcap-project-to-a-r-data-package."><span class="toc-section-number">3</span> Exporting a REDCap Project to a R Data Package.</a></li>
<li><a href="#session-info"><span class="toc-section-number">4</span> Session Info</a></li>
</ul>
</div>

<p>The purpose of this vignette is to show how to export a REDCap project into a R data package. There are some prerequisites, described in detail in the first section, you will need to address before running the examples.</p>
<p>The primary objective of the <em>REDCapExporter</em> is to export all the data from an REDCap project via the REDCap API and build a R data package with useful documentation and tools. The data package will make it easy to archive data and distribute data, in an analysis ready format, within a group of analysts.</p>
<p><strong>Disclaimer and Warning:</strong> It is the responsibility of the end user to protect sensitive data. Do not use <em>REDCapExporter</em> to export data onto a computer that should not have sensitive data stored on it. Further, do not distribute the resulting R package to any other machine or person who does not have data access rights.</p>
<p>For the example in this vignette we created a REDCap project storing the roster and statistics for the 2000-2001 Stanley Cup Champion Colorado Avalanche of the National Hockey League. The data was acquired from the web page <a href="https://www.hockey-reference.com/teams/COL/2001.html">Hockey Reference</a>.</p>
<div id="prerequisites-and-tokens" class="section level1">
<h1><span class="header-section-number">1</span> Prerequisites and Tokens</h1>
<p>You will need to have API Export rights for the REDCap project you are looking to export into an R data package. Contact the project owner, system admin, or go through your institution’s REDCap page to acquire an API token.</p>
<p>Remember, your API token is the equivalent of a username/password combination. Thus, you must treat the token with the same, or more, level of security you would treat any username/password combination. <strong>DO NOT PUT THE TOKEN IN PLAIN TEXT!</strong></p>
<p>There are many ways to deal with tokens. One option would be two require the end user to enter the key interactively via <a href="https://cran.r-project.org/package=getPass">getPass</a>, e.g.,</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># a_token &lt;- getPass::getPass()</span></a></code></pre></div>
<p>However, there are at least two issues with this approach:</p>
<ol style="list-style-type: decimal">
<li>It is interactive and cannot be scripted.</li>
<li>Storing the token in an object would make it possible to divulge the token, either accidentally or via malicious intent.</li>
</ol>
<p>A better way to handle API tokens is to use the <a href="https://cran.r-project.org/package=secret">secret</a>. We encourage the reader to read the “secrets” vignette. <code>vignette(topic = &quot;secrets&quot;, package = &quot;secret&quot;)</code></p>
<p>We suggest the reader set up a vault with their API token as a secret. Accessing the secret in scripts can be done non-interactively and will a lower chance of accidental or malicious divulging of a token.</p>
<p>For the rest of this vignette we will use <code>secret::get_secret()</code> to assess a REDCap API token.</p>
<div id="namespaces-options-and-system-environment-variables" class="section level2">
<h2><span class="header-section-number">1.1</span> Namespaces, Options, and System Environment Variables</h2>
<p>For this example we will load and attach the following namespaces and set several options and system environment variables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(REDCapExporter)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(secret)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">## Registered S3 method overwritten by 'openssl':</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">##   method      from</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">##   print.bytes Rcpp</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">library</span>(qwraps2)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw">options</span>(<span class="st">&quot;datatable.print.topn&quot;</span>  =<span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">options</span>(<span class="st">&quot;datatable.print.nrows&quot;</span> =<span class="st"> </span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># private key needed to access the vault</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="kw">Sys.setenv</span>(<span class="dt">USER_KEY =</span> <span class="st">&quot;~/.ssh/vaults&quot;</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># REDCap API uri and token</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw">Sys.setenv</span>(<span class="dt">REDCap_API_uri =</span> <span class="st">&quot;https://redcap.ucdenver.edu/api/&quot;</span>)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="kw">Sys.setenv</span>(<span class="dt">REDCap_API_TOKEN =</span> <span class="kw">get_secret</span>(<span class="st">&quot;2000_2001_Avalanche&quot;</span>))</a>
<a class="sourceLine" id="cb2-19" data-line-number="19"></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># Set the option the format the data will be returned in.  Possible values are</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co"># 'csv', 'xml', or 'json'. The default is 'csv', set when</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co"># qwraps2::Rpkg(REDCapExporter) is loaded.</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="kw">Sys.getenv</span>(<span class="st">&quot;REDCap_API_format&quot;</span>)</a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">## [1] &quot;csv&quot;</span></a></code></pre></div>
</div>
</div>
<div id="general-tools" class="section level1">
<h1><span class="header-section-number">2</span> General Tools</h1>
<p>The <em>REDCapExporter</em> package provides several functions and methods which the user may find useful. These functions and methods are used within the package to export and create a R data package. Use of the methods for specific projects, say exporting data from a REDCap project for routine reports or interim analyses.</p>
<div id="specific-export-methods" class="section level2">
<h2><span class="header-section-number">2.1</span> Specific Export Methods</h2>
<p>The method <code>export_content</code> can be used to export specific parts of a REDCap project. Three of the arguments, <code>uri</code>, <code>token</code>, and <code>format</code>, passed to <code>export_content</code>, if omitted, will default to the system environment variables. Thus, only the <code>content</code> argument must be defined by the user. Additional arguments for the API are passed via the <code>...</code>. Check your specific REDCap API documentation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">str</span>(export_content)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## function (uri, token, content, format, ...)</span></a></code></pre></div>
<p>For example, the project information and project metadata can be obtained via:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">avs_raw_project_info &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;project&quot;</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">avs_raw_metadata     &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;metadata&quot;</span>)</a></code></pre></div>
<p>The return object from <code>export_content</code> are character strings as you would expect from a call to <code>postForm</code> from the <a href="https://cran.r-project.org/package=RCurl"><em>RCurl</em></a> package. A couple additional attributes have been added. The <code>Sys.time</code> for the call and the class <code>rcer_raw_*</code> where <code>*</code> is replaced by the value of the <code>content</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">str</span>(avs_raw_project_info)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">##  'rcer_raw_project' chr &quot;project_id,project_title,creation_time,production_time,in_production,project_language,purpose,purpose_other,pro&quot;| __truncated__</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">##  - attr(*, &quot;Content-Type&quot;)= Named chr [1:2] &quot;text/csv&quot; &quot;utf-8&quot;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;&quot; &quot;charset&quot;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">##  - attr(*, &quot;accessed&quot;)= POSIXct[1:1], format: &quot;2019-03-01 14:02:48&quot;</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">str</span>(avs_raw_metadata)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">##  'rcer_raw_metadata' chr &quot;field_name,form_name,section_header,field_type,field_label,select_choices_or_calculations,field_note,text_valid&quot;| __truncated__</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##  - attr(*, &quot;Content-Type&quot;)= Named chr [1:2] &quot;text/csv&quot; &quot;utf-8&quot;</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;&quot; &quot;charset&quot;</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">##  - attr(*, &quot;accessed&quot;)= POSIXct[1:1], format: &quot;2019-03-01 14:02:48&quot;</span></a></code></pre></div>
<p>We opted to have <code>export_content</code> return a character string such that the end user can may select the format for the return and use the tool of their choice for creating a <code>data.frame</code>. For example, creating a <code>data.table</code> from the csv or json formats.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">from_csv &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(<span class="dt">input =</span> avs_raw_metadata, <span class="dt">colClasses =</span> <span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">from_json &lt;-</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;metadata&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;json&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span>rjson<span class="op">::</span><span class="kw">fromJSON</span>(<span class="dt">json_str =</span> .) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">lapply</span>(as.data.table) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span>rbindlist</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw">identical</span>(from_csv, from_json)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">## [1] TRUE</span></a></code></pre></div>
<p>A easier way to get the raw export into a  or  is to use the <code>as.data.frame</code> or <code>as.data.table</code> methods.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">csv_metadata  &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;metadata&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;csv&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">json_metadata &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;metadata&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;json&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">df_from_csv  &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(csv_metadata)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">df_from_json &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(json_metadata)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">identical</span>(df_from_csv, df_from_json)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">dt_from_csv  &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(csv_metadata)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">dt_from_json &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(json_metadata)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">identical</span>(dt_from_csv, dt_from_json)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">## [1] TRUE</span></a></code></pre></div>
</div>
<div id="data-import-tools" class="section level2">
<h2><span class="header-section-number">2.2</span> Data Import Tools</h2>
<p>When working with REDCap data it is likely that you will have more collumns than you would want to have to code a data import method for yourself. This is especially true if you need to deal with columns that may look like numeric values but are really categorical. We provide some tools to help with the data import process.</p>
<p>First, you will need to get the project metadata and record.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">avs_raw_metadata &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;metadata&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">avs_raw_record   &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;record&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">avs_metadata &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(avs_raw_metadata)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">avs_record   &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(avs_raw_record)</a></code></pre></div>
<p>The function <code>col_type</code> will take the metadata and return a list of calls to set the specific storage modes of the projet record.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">identical</span>(<span class="kw">col_type</span>(avs_raw_metadata), <span class="kw">col_type</span>(avs_metadata))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">ct &lt;-<span class="st"> </span><span class="kw">col_type</span>(avs_metadata)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">str</span>(ct)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">## List of 64</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">##  $ record_id                     : language as.character(record_id)</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">##  $ uniform_number                : language as.character(uniform_number)</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">##  $ firstname                     : language as.character(firstname)</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">##  $ lastname                      : language as.character(lastname)</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">##  $ hof                           : language as.integer(hof)</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">##  $ nationality                   : language as.character(nationality)</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">##  $ position                      : language factor(x = position, levels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;), labels = c(&quot;Goal&quot;,  &quot;Left Wing&quot;, &quot;Right Wing&quot;, &quot;Center&quot;, &quot;Defence&quot;))</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">##  $ birthdate                     : language lubridate::ymd(birthdate)</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">##  $ height                        : language as.integer(height)</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">##  $ weight                        : language as.integer(weight)</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">##  $ shoots                        : language factor(x = shoots, levels = c(&quot;0&quot;, &quot;1&quot;), labels = c(&quot;Left&quot;, &quot;Right&quot; ))</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">##  $ catches                       : language factor(x = catches, levels = c(&quot;0&quot;, &quot;1&quot;), labels = c(&quot;Left&quot;, &quot;Right&quot; ))</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">##  $ experience                    : language as.integer(experience)</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">##  $ gp                            : language as.integer(gp)</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">##  $ goals                         : language as.integer(goals)</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">##  $ assists                       : language as.integer(assists)</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">##  $ points                        : language as.numeric(points)</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">##  $ plusmn                        : language as.integer(plusmn)</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">##  $ pimi                          : language as.integer(pimi)</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">##  $ goals_ev                      : language as.integer(goals_ev)</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">##  $ goals_pp                      : language as.integer(goals_pp)</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">##  $ goals_sh                      : language as.integer(goals_sh)</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">##  $ goals_gw                      : language as.integer(goals_gw)</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">##  $ assists_ev                    : language as.integer(assists_ev)</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">##  $ assists_pp                    : language as.integer(assists_pp)</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">##  $ assists_sh                    : language as.integer(assists_sh)</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">##  $ shots                         : language as.integer(shots)</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">##  $ shooting_percentage           : language as.numeric(shooting_percentage)</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">##  $ toi                           : language as.integer(toi)</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">##  $ atoi                          : language as.character(atoi)</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">##  $ wins                          : language as.integer(wins)</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">##  $ losses                        : language as.integer(losses)</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">##  $ ties_otl                      : language as.integer(ties_otl)</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">##  $ goals_against                 : language as.integer(goals_against)</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">##  $ shots_against                 : language as.integer(shots_against)</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co">##  $ saves                         : language as.integer(saves)</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co">##  $ save_percentage               : language as.numeric(save_percentage)</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co">##  $ gaa                           : language as.numeric(gaa)</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co">##  $ so                            : language as.integer(so)</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">##  $ gp_postseason                 : language as.integer(gp_postseason)</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">##  $ goals_postseason              : language as.integer(goals_postseason)</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">##  $ assists_postseason            : language as.integer(assists_postseason)</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">##  $ points_postseason             : language as.numeric(points_postseason)</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">##  $ plusmn_postseason             : language as.integer(plusmn_postseason)</span></a>
<a class="sourceLine" id="cb9-51" data-line-number="51"><span class="co">##  $ pimi_postseason               : language as.integer(pimi_postseason)</span></a>
<a class="sourceLine" id="cb9-52" data-line-number="52"><span class="co">##  $ goals_ev_postseason           : language as.integer(goals_ev_postseason)</span></a>
<a class="sourceLine" id="cb9-53" data-line-number="53"><span class="co">##  $ goals_pp_postseason           : language as.integer(goals_pp_postseason)</span></a>
<a class="sourceLine" id="cb9-54" data-line-number="54"><span class="co">##  $ goals_sh_postseason           : language as.integer(goals_sh_postseason)</span></a>
<a class="sourceLine" id="cb9-55" data-line-number="55"><span class="co">##  $ goals_gw_postseason           : language as.integer(goals_gw_postseason)</span></a>
<a class="sourceLine" id="cb9-56" data-line-number="56"><span class="co">##  $ assists_ev_postseason         : language as.integer(assists_ev_postseason)</span></a>
<a class="sourceLine" id="cb9-57" data-line-number="57"><span class="co">##  $ assists_pp_postseason         : language as.integer(assists_pp_postseason)</span></a>
<a class="sourceLine" id="cb9-58" data-line-number="58"><span class="co">##  $ assists_sh_postseason         : language as.integer(assists_sh_postseason)</span></a>
<a class="sourceLine" id="cb9-59" data-line-number="59"><span class="co">##  $ shots_postseason              : language as.integer(shots_postseason)</span></a>
<a class="sourceLine" id="cb9-60" data-line-number="60"><span class="co">##  $ shooting_percentage_postseason: language as.numeric(shooting_percentage_postseason)</span></a>
<a class="sourceLine" id="cb9-61" data-line-number="61"><span class="co">##  $ toi_postseason                : language as.integer(toi_postseason)</span></a>
<a class="sourceLine" id="cb9-62" data-line-number="62"><span class="co">##  $ atoi_postseason               : language as.character(atoi_postseason)</span></a>
<a class="sourceLine" id="cb9-63" data-line-number="63"><span class="co">##  $ wins_postseason               : language as.integer(wins_postseason)</span></a>
<a class="sourceLine" id="cb9-64" data-line-number="64"><span class="co">##  $ losses_postseason             : language as.integer(losses_postseason)</span></a>
<a class="sourceLine" id="cb9-65" data-line-number="65"><span class="co">##  $ ties_otl_postseason           : language as.integer(ties_otl_postseason)</span></a>
<a class="sourceLine" id="cb9-66" data-line-number="66"><span class="co">##  $ goals_allowed_postseason      : language as.integer(goals_allowed_postseason)</span></a>
<a class="sourceLine" id="cb9-67" data-line-number="67"><span class="co">##  $ saves_postseason              : language as.integer(saves_postseason)</span></a>
<a class="sourceLine" id="cb9-68" data-line-number="68"><span class="co">##  $ save_percentage_postseason    : language as.numeric(save_percentage_postseason)</span></a>
<a class="sourceLine" id="cb9-69" data-line-number="69"><span class="co">##  $ gaa_postseason                : language as.numeric(gaa_postseason)</span></a>
<a class="sourceLine" id="cb9-70" data-line-number="70"><span class="co">##  $ so_postseason                 : language as.integer(so_postseason)</span></a></code></pre></div>
<p>The function <code>format_records()</code> will build a <code>data.frame</code> for the the project records using the columns types defined by <code>col_type()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># format_records(avs_metadata, avs_raw_records)</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">temp1 &lt;-<span class="st"> </span><span class="kw">format_record</span>(avs_raw_metadata, avs_raw_record)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">temp2 &lt;-<span class="st"> </span><span class="kw">format_record</span>(avs_raw_metadata, avs_record)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">temp3 &lt;-<span class="st"> </span><span class="kw">format_record</span>(avs_metadata,     avs_raw_record)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">temp4 &lt;-<span class="st"> </span><span class="kw">format_record</span>(avs_metadata,     avs_record)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw">identical</span>(temp1, temp2)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="kw">identical</span>(temp1, temp3)</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw">identical</span>(temp1, temp4)</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="kw">str</span>(temp1)</a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">## 'data.frame':    32 obs. of  64 variables:</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">##  $ record_id                     : chr  &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">##  $ uniform_number                : chr  &quot;1&quot; &quot;46&quot; &quot;45&quot; &quot;4&quot; ...</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">##  $ firstname                     : chr  &quot;David&quot; &quot;Yuri&quot; &quot;Rick&quot; &quot;Rob&quot; ...</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">##  $ lastname                      : chr  &quot;Aebischer&quot; &quot;Babenko&quot; &quot;Berry&quot; &quot;Blake&quot; ...</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">##  $ hof                           : int  0 0 0 1 1 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">##  $ nationality                   : chr  &quot;Swiss&quot; &quot;USSR&quot; &quot;Canada&quot; &quot;Canada&quot; ...</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">##  $ position                      : Factor w/ 5 levels &quot;Goal&quot;,&quot;Left Wing&quot;,..: 1 4 5 5 5 5 3 2 2 5 ...</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">##  $ birthdate                     : Date, format: &quot;1978-02-07&quot; &quot;1978-01-02&quot; ...</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">##  $ height                        : int  73 73 74 76 71 74 72 76 70 74 ...</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">##  $ weight                        : int  185 200 210 220 219 205 205 235 191 220 ...</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">##  $ shoots                        : Factor w/ 2 levels &quot;Left&quot;,&quot;Right&quot;: NA 1 1 2 1 1 2 1 2 2 ...</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">##  $ catches                       : Factor w/ 2 levels &quot;Left&quot;,&quot;Right&quot;: 1 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">##  $ experience                    : int  0 0 0 11 21 5 6 3 2 9 ...</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">##  $ gp                            : int  26 3 19 13 80 79 39 41 71 35 ...</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">##  $ goals                         : int  0 0 0 2 7 5 13 1 24 3 ...</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">##  $ assists                       : int  1 0 4 8 52 12 13 1 41 12 ...</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">##  $ points                        : num  1 0 4 10 59 17 26 2 65 15 ...</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">##  $ plusmn                        : int  0 0 5 11 25 23 -2 -3 6 6 ...</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">##  $ pimi                          : int  0 0 38 8 48 51 59 108 47 42 ...</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">##  $ goals_ev                      : int  0 0 0 1 3 5 6 1 13 1 ...</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">##  $ goals_pp                      : int  0 0 0 1 2 0 7 0 11 1 ...</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">##  $ goals_sh                      : int  0 0 0 0 2 0 0 0 0 1 ...</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">##  $ goals_gw                      : int  0 0 0 1 0 0 2 0 5 1 ...</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">##  $ assists_ev                    : int  NA 0 4 6 21 11 7 1 22 7 ...</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">##  $ assists_pp                    : int  NA 0 0 2 31 0 6 0 18 5 ...</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">##  $ assists_sh                    : int  NA 0 0 0 0 1 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">##  $ shots                         : int  0 2 10 44 216 76 86 33 204 59 ...</span></a>
<a class="sourceLine" id="cb10-44" data-line-number="44"><span class="co">##  $ shooting_percentage           : num  0 0 0 4.55 3.24 ...</span></a>
<a class="sourceLine" id="cb10-45" data-line-number="45"><span class="co">##  $ toi                           : int  1393 32 231 339 2088 1351 687 264 1281 888 ...</span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46"><span class="co">##  $ atoi                          : chr  &quot;53:34&quot; &quot;10:34&quot; &quot;12:08&quot; &quot;26:03&quot; ...</span></a>
<a class="sourceLine" id="cb10-47" data-line-number="47"><span class="co">##  $ wins                          : int  12 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-48" data-line-number="48"><span class="co">##  $ losses                        : int  7 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49"><span class="co">##  $ ties_otl                      : int  3 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-50" data-line-number="50"><span class="co">##  $ goals_against                 : int  52 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-51" data-line-number="51"><span class="co">##  $ shots_against                 : int  538 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-52" data-line-number="52"><span class="co">##  $ saves                         : int  486 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-53" data-line-number="53"><span class="co">##  $ save_percentage               : num  0.903 NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-54" data-line-number="54"><span class="co">##  $ gaa                           : num  2.24 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-55" data-line-number="55"><span class="co">##  $ so                            : int  3 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-56" data-line-number="56"><span class="co">##  $ gp_postseason                 : int  1 0 0 23 21 23 0 16 23 23 ...</span></a>
<a class="sourceLine" id="cb10-57" data-line-number="57"><span class="co">##  $ goals_postseason              : int  0 NA NA 6 4 0 NA 0 11 3 ...</span></a>
<a class="sourceLine" id="cb10-58" data-line-number="58"><span class="co">##  $ assists_postseason            : int  0 NA NA 13 6 1 NA 4 5 4 ...</span></a>
<a class="sourceLine" id="cb10-59" data-line-number="59"><span class="co">##  $ points_postseason             : num  0 NA NA 19 10 1 NA 4 16 7 ...</span></a>
<a class="sourceLine" id="cb10-60" data-line-number="60"><span class="co">##  $ plusmn_postseason             : int  0 NA NA 6 9 5 NA 3 5 5 ...</span></a>
<a class="sourceLine" id="cb10-61" data-line-number="61"><span class="co">##  $ pimi_postseason               : int  0 NA NA 16 12 20 NA 14 4 47 ...</span></a>
<a class="sourceLine" id="cb10-62" data-line-number="62"><span class="co">##  $ goals_ev_postseason           : int  0 NA NA 3 1 0 NA 0 9 2 ...</span></a>
<a class="sourceLine" id="cb10-63" data-line-number="63"><span class="co">##  $ goals_pp_postseason           : int  0 NA NA 3 3 0 NA 0 2 1 ...</span></a>
<a class="sourceLine" id="cb10-64" data-line-number="64"><span class="co">##  $ goals_sh_postseason           : int  0 NA NA 0 0 0 NA 0 0 0 ...</span></a>
<a class="sourceLine" id="cb10-65" data-line-number="65"><span class="co">##  $ goals_gw_postseason           : int  0 NA NA 0 1 0 NA 0 2 1 ...</span></a>
<a class="sourceLine" id="cb10-66" data-line-number="66"><span class="co">##  $ assists_ev_postseason         : int  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-67" data-line-number="67"><span class="co">##  $ assists_pp_postseason         : int  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-68" data-line-number="68"><span class="co">##  $ assists_sh_postseason         : int  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-69" data-line-number="69"><span class="co">##  $ shots_postseason              : int  0 NA NA 83 49 20 NA 8 62 28 ...</span></a>
<a class="sourceLine" id="cb10-70" data-line-number="70"><span class="co">##  $ shooting_percentage_postseason: num  NA NA NA 7.23 8.16 ...</span></a>
<a class="sourceLine" id="cb10-71" data-line-number="71"><span class="co">##  $ toi_postseason                : int  1 NA NA 677 599 328 NA 101 439 652 ...</span></a>
<a class="sourceLine" id="cb10-72" data-line-number="72"><span class="co">##  $ atoi_postseason               : chr  &quot;00:32&quot; &quot;&quot; &quot;&quot; &quot;29:26&quot; ...</span></a>
<a class="sourceLine" id="cb10-73" data-line-number="73"><span class="co">##  $ wins_postseason               : int  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-74" data-line-number="74"><span class="co">##  $ losses_postseason             : int  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-75" data-line-number="75"><span class="co">##  $ ties_otl_postseason           : int  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-76" data-line-number="76"><span class="co">##  $ goals_allowed_postseason      : int  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-77" data-line-number="77"><span class="co">##  $ saves_postseason              : int  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-78" data-line-number="78"><span class="co">##  $ save_percentage_postseason    : num  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-79" data-line-number="79"><span class="co">##  $ gaa_postseason                : num  0 NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb10-80" data-line-number="80"><span class="co">##  $ so_postseason                 : int  0 NA NA NA NA NA NA NA NA NA ...</span></a></code></pre></div>
</div>
</div>
<div id="exporting-a-redcap-project-to-a-r-data-package." class="section level1">
<h1><span class="header-section-number">3</span> Exporting a REDCap Project to a R Data Package.</h1>
<p>Exporting a REDCap project to a R data package is done with a call to <code>export_redcap_project()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">str</span>(export_redcap_project)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">## function (uri, token, other_exports, path = NULL, verbose = TRUE)</span></a></code></pre></div>
<p>The <code>path</code> argument is a directory on your machine were the R data package is going to be built. For this vignette we will use a temporary directory.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">temppath &lt;-<span class="st"> </span><span class="kw">tempdir</span>()</a></code></pre></div>
<p>The exported package name and directory will be <code>rcd&lt;project-id&gt;</code>, that is, <code>rcd</code> for ‘REDCap Data’ and the project-id which, for this example is:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">as.data.frame</span>(avs_raw_project_info)<span class="op">$</span>project_id</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">## [1] &quot;14465&quot;</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">avs_raw_user &lt;-<span class="st"> </span><span class="kw">export_content</span>(<span class="dt">content =</span> <span class="st">&quot;user&quot;</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw">as.data.frame</span>(avs_raw_user)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">##   username                     email firstname lastname expiration</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">## 1  dewittp peter.dewitt@ucdenver.edu     Peter   DeWitt           </span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">##   data_access_group data_access_group_id design user_rights</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">## 1                                             1           1</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">##   data_access_groups data_export reports stats_and_charts</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">## 1                  1           1       1                1</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">##   manage_survey_participants calendar data_import_tool</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">## 1                          1        1                1</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">##   data_comparison_tool logging file_repository data_quality_create</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">## 1                    1       1               1                   1</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">##   data_quality_execute api_export api_import mobile_app</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">## 1                    1          1          0          1</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">##   mobile_app_download_data record_create record_rename record_delete</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">## 1                        1             1             0             0</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">##   lock_records_all_forms lock_records lock_records_customization</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">## 1                      0            0                          0</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">##                                                                                                      forms</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">## 1 roster:1,regular_season_scoring:1,regular_season_goalies:1,post_season_scoring:1,post_season_goalies_2:1</span></a></code></pre></div>
<p>Thus we expect the source package to be at</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">prj_path &lt;-</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">paste</span>(temppath, <span class="kw">paste0</span>(<span class="st">&quot;rcd&quot;</span>, <span class="kw">as.data.frame</span>(avs_raw_project_info)<span class="op">$</span>project_id), <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">prj_path</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">## [1] &quot;/tmp/RtmpUgYo6b/rcd14465&quot;</span></a></code></pre></div>
<p>Exporting the project</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">export_redcap_project</span>(<span class="dt">path =</span> temppath)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">## Getting Project Info</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">## Getting project metadata</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">## Getting user data</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">## Getting project record</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">## Creating source package at /tmp/RtmpUgYo6b/rcd14465</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw">list.files</span>(prj_path, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">## [1] &quot;DESCRIPTION&quot;                    &quot;inst/raw-data/metadata.rds&quot;    </span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">## [3] &quot;inst/raw-data/project_info.rds&quot; &quot;inst/raw-data/records.rds&quot;     </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">## [5] &quot;inst/raw-data/user.rds&quot;         &quot;LICENSE&quot;</span></a></code></pre></div>
<p>Let’s look at some of the files which have been placed into the project path. We will start with the DESCRIPTION file.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">read.dcf</span>(<span class="kw">paste</span>(prj_path, <span class="st">&quot;DESCRIPTION&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">##      Package    Title                          Version           </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">## [1,] &quot;rcd14465&quot; &quot;2000-2001 Colorado Avalanche&quot; &quot;2019.03.01.14.03&quot;</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">##      Authors@R                                                        </span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">## [1,] &quot;c(person(\&quot;Peter\&quot;, \&quot;DeWitt\&quot;, \&quot;peter.dewitt@ucdenver.edu\&quot;))&quot;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">##      Description                                       License       </span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">## [1,] &quot;Data and documentation from the REDCap Project.&quot; &quot;file LICENSE&quot;</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">##      Encoding LazyData Suggests VignetteBuilder</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">## [1,] &quot;UTF-8&quot;  &quot;true&quot;   &quot;knitr&quot;  &quot;knitr&quot;</span></a></code></pre></div>
<p>The package name is as noted above, the verions number is worth noting, the version is the year.month.day.hour.minute for when the data was exported from REDCap.</p>
<p>The Author field is also of note. Authors are ge</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># write_authors(avs_raw_user)</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># devtools::check(pkg = prj_path)</span></a></code></pre></div>
</div>
<div id="session-info" class="section level1">
<h1><span class="header-section-number">4</span> Session Info</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">sessionInfo</span>(), <span class="dt">local =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">## R Under development (unstable) (2019-01-13 r75986)</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">## Running under: Debian GNU/Linux 9 (stretch)</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">## Matrix products: default</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">## BLAS/LAPACK: /usr/lib/libopenblasp-r0.2.19.so</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">## attached base packages:</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">## other attached packages:</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">## [1] qwraps2_0.4.0             secret_1.0.0             </span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">## [3] magrittr_1.5              data.table_1.12.0        </span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">## [5] REDCapExporter_0.0.0.9000</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">## loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">##  [1] Rcpp_1.0.0       knitr_1.21       rjson_0.2.20     rlang_0.3.1     </span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="co">##  [5] stringr_1.4.0    tools_3.6.0      xfun_0.5         htmltools_0.3.6 </span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">##  [9] askpass_1.1      openssl_1.2.2    yaml_2.2.0       digest_0.6.18   </span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">## [13] assertthat_0.2.0 rprojroot_1.3-2  bitops_1.0-6     RCurl_1.95-4.11 </span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co">## [17] curl_3.3         evaluate_0.13    rmarkdown_1.11   stringi_1.3.1   </span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="co">## [21] compiler_3.6.0   backports_1.1.3  lubridate_1.7.4  jsonlite_1.6</span></a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#</span></a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
